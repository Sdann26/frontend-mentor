"use strict";var e=require("glob"),t=require("plugin-error"),r=require("purgecss"),n=require("through2");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=u(e),c=u(t),o=u(r),i=u(n);module.exports=function(e){return i.default.obj((async function(t,r,n){if(t.isNull())return n(null,t);if(t.isBuffer())try{const r={...e,content:(u=e.content,u.reduce(((e,t)=>[...e,...s.default.sync(t)]),[])),css:[{raw:t.contents.toString()}],stdin:!0},c=(await(new o.default).purge(r))[0],i=r.rejected&&c.rejected?c.rejected.join(" {}\n")+" {}":c.css;t.contents=Buffer.from(i,"utf-8"),n(null,t)}catch(e){e instanceof Error&&this.emit("error",new c.default("gulp-purgecss",e.message))}var u;if(t.isStream()){let r="";t.contents.on("data",(e=>{r+=e.toString()})).on("end",(async()=>{try{const u={...e,css:[{raw:r}]},s=(await(new o.default).purge(u))[0],c=u.rejected&&s.rejected?s.rejected.join(" {}\n")+" {}":s.css,a=i.default();a.write(Buffer.from(c,"utf-8")),t.contents=t.contents.pipe(a),n(null,t)}catch(e){e instanceof Error&&this.emit("error",new c.default("gulp-purgecss",e.message))}}))}}))};
